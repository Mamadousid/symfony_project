{% extends 'themes/base_admin.html.twig' %}

{% block title %}Liste des produits{% endblock %}

{% block description %}Liste des produits{% endblock %}

{% block main %}
    <h1 class="text-center my-3 display-5">Liste des produits</h1>

        <div class="d-flex justify-content-end align-items-center my-3">
         <a href="{{path('admin_product_create')}}" class="btn btn-primary shadow"><i class="fa-solid fa-plus"></i> Nouveau produit</a>
    </div>

    <div class="table-responsive">
          <table class="table table-striped table-hover table-bordered text-center">
               <thead>
                   <tr>
                      <th>Id</th>
                      <th>Titre</th>
                      <th>Catégorie</th>
                      <th>Description</th>
                      <th>Image</th>
                      <th>crée le</th>
                      <th>Modifié le</th>
                      <th>Options</th>
                   </tr>
               </thead>
               <tbody>
                    {% for product in products %}
                        <tr>
                           <td>{{product.id}}</td>
                           <td>{{product.title}}</td>
                           <td>{{product.category.name}}</td>
                           <td>{{product.description}}</td>
                           <td>
                           {% if product.image %}
                                <img class="img-fluid" src="{{ vich_uploader_asset(product, 'imageFile')|imagine_filter('admin_product_thumb')}}">
                           {% endif %}
                            
                           </td>
                           <td>{{product.createdAt|format_datetime()}}</td>
                           <td>{{product.updatedAt|format_datetime()}}</td>
                           <td>
                               <a class="mx-2 text-secondary" href="{{path('admin_product_edit', {'id':product.id})}}"><i class="fa-solid fa-pen-to-square"></i></a>
                               <a onclick="event.preventDefault(); return confirm('Confirmer la supression?') && document.querySelector('#delete_product_{{product.id}}_form').submit();" class="mx-2 text-danger" href=""><i class="fa-solid fa-trash"></i></a>

                               <form id="delete_product_{{product.id}}_form" method="POST" action="{{path('admin_product_delete', {'id':product.id})}}">
                                      <input type="hidden" name="_method" value="DELETE">
                                      <input type="hidden" name="csrf_token" value="{{csrf_token('delete_product_'~product.id)}}">
                                </form>
                           </td>
                        </tr>
                    {% endfor %}
               </tbody>
          </table>
    </div>
{% endblock %}